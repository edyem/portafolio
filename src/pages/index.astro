---
import Layout from "../layouts/Layout.astro";
import ThemeToggles from "../components/ThemeToggles.jsx";
import Hero from "../components/Hero.astro";
import { getCollection } from "astro:content";

const proyects = await getCollection("proyects");
proyects.sort((a, b) => b.data.date - a.data.date);

console.log(proyects)
---

<Layout>
  <main class="page-main">
    <ThemeToggles client:load />

    <Hero />

    <section aria-label="Proyectos" class="projects">
      <div class="projects-list">
        {proyects.map((p) => {
          const { title, date, description, imagen } = p.data;

          return (
            <article class="project-card">
              <div class="project-imageWrapper">
                <img
                  src={imagen.startsWith("/") ? imagen : `/${imagen}`}
                  alt={title}
                  class="project-image"
                  loading="lazy"
                />
                <div class="project-overlay">
                  <h3 class="project-title">{title}</h3>
                  <h4 class="project-year muted">{date}</h4>
                  <p class="project-description muted">{description}</p>
                </div>
              </div>

              <div class="project-meta">
                <h3 class="project-title">
                  {title} <span class="project-yearInline muted">({date})</span>
                </h3>
                <p class="project-description muted">{description}</p>
              </div>
            </article>
          );
        })}
      </div>
    </section>
  </main>
</Layout>
